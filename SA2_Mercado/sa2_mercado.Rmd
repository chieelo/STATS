---
title: "SA2"
author: "Mercado"
output:
  pdf_document:
    latex_engine: lualatex
  html_document: default
  word_document: default
---


# Introduction

This report analyzes the effects of AD status (Transgenic vs. Wild-Type) and drug treatment (four levels) on training-day maze errors in mice.\
A 2-way between-subjects ANOVA is performed, and assumptions of normality and homogeneity of variances are checked.

```{r}
library(tidyverse)
library(knitr)

data <- tribble(
  ~AD_Status, ~Treatment, ~Training, ~Memory,
  1, 1, 12, 10,
  1, 1, 15, 12,
  1, 1, 13, 13,
  1, 1, 12, 10,
  1, 1, 14, 13,
  1, 2, 15, 13,
  1, 2, 17, 13,
  1, 2, 16, 14,
  1, 2, 17, 15,
  1, 2, 14, 11,
  1, 3, 13, 12,
  1, 3, 14, 11,
  1, 3, 18, 15,
  1, 3, 15, 10,
  1, 3, 16, 14,
  1, 4, 14, 12,
  1, 4, 13, 11,
  1, 4, 12, 10,
  1, 4, 14, 13,
  1, 4, 15, 10,
  2, 1, 17, 9,
  2, 1, 16, 8,
  2, 1, 17, 10,
  2, 1, 14, 8,
  2, 1, 13, 8,
  2, 2, 14, 7,
  2, 2, 18, 10,
  2, 2, 16, 5,
  2, 2, 17, 9,
  2, 2, 14, 7,
  2, 3, 13, 8,
  2, 3, 14, 7,
  2, 3, 18, 9,
  2, 3, 15, 8,
  2, 3, 16, 9,
  2, 4, 14, 7,
  2, 4, 13, 9,
  2, 4, 12, 5,
  2, 4, 14, 8,
  2, 4, 15, 4
)

# Convert to factors
data <- data %>%
  mutate(
    AD_Status = factor(AD_Status, labels = c("Transgenic", "Wild")),
    Treatment = factor(Treatment, labels = c("Drug1", "Drug2", "Drug3", "Drug4"))
  )

# Show first 10 rows
head(data, 10) %>%
  knitr::kable(
    caption = "Alzheimer’s Mice Dataset (First 10 Rows)"
  )

```

## Assumptions

Prior to conducting the ANOVA, the underlying assumptions will be evaluated:

**Assumption 1:** You have one dependent variable that is measured at the continuous level.

**Assumption 2**: You have one independent variable that consists of three or more categorical, independent groups.

**Assumption 3:** You should have independence of observations, which means that there is no relationship between the observations in each group of the independent variable or among the groups themselves.

**Assumption 4:** There should be no significant outliers in the three or more groups of your independent variable in terms of the dependent variable.

**Assumption 5:** Your dependent variable should be approximately normally distributed for each group of the independent variable.

**Assumption 6:** You have homogeneity of variances (i.e., the variance of the dependent variable is equal in each group of your independent variable).

## Data Description

Mice are used in an experiment to test drugs that may prevent Alzheimer’s disease.
Half the mice are transgenic – have been genetically modified to have Alzheimer’s disease.
The other half of the mice are “wild type” – they have not been modified in any way, and are considered free of Alzheimer’s disease.
The mice are assigned to treatment conditions and given one of four drugs, then tested on memory using a maze.
The number of errors made in the maze is recorded for the Training Day and the Memory Day.

## **Null and Alternative Hypotheses**

For Training Day errors:

H₀: There are no differences in mean Training Day errors across AD Status and Treatment groups, and there is no interaction.

H₁: There is a difference in mean Training Day errors due to AD Status, Treatment, or their interaction.

For Memory Day errors:

H₀: There are no differences in mean Memory Day errors across AD Status and Treatment groups, and there is no interaction.

H₁: There is a difference in mean Memory Day errors due to AD Status, Treatment, or their interaction.

## Descriptive Statistics

```{r descriptive-stats}
data %>%
  group_by(AD_Status, Treatment) %>%
  summarise(
    Training_Mean = mean(Training),
    Training_SD = sd(Training),
    Memory_Mean = mean(Memory),
    Memory_SD = sd(Memory),
    .groups = "drop"
  ) %>%
  knitr::kable(
    caption = "Means and Standard Deviations of Training and Memory Errors by AD Status and Treatment",
    digits = 2
  )

```

## Checking of Assumptions

***Assumption 1:*** The dependent variables (Training and Memory errors) are continuous.

Remark: Both variables are continuous count data, meeting this assumption.

***Assumption 2:*** The independent variables (AD Status and Treatment) are categorical.

Remark: AD Status has 2 levels (Transgenic, Wild) and Treatment has 4 levels (Drug1–Drug4).

***Assumption 3:*** Independence of observations.

Remark: Each mouse appears only in one AD Status × Treatment group, ensuring independence.

***Assumption 4:*** No significant outliers.

```{r}
library(ggplot2)

data %>%
  mutate(Group = paste0("AD", AD_Status, "_Drug", Treatment)) %>%
  ggplot(aes(x = Group, y = Training)) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "Boxplot of Training Errors by AD Status × Treatment",
       x = "Group", y = "Training Errors") +
  theme_minimal()
```

**Remark.** No extreme outliers were observed.

Assumption 5: Normality of residuals.

```{r}
library(rstatix)

data %>%
group_by(AD_Status, Treatment) %>%
shapiro_test(Training)
data %>%
  
group_by(AD_Status, Treatment) %>%
shapiro_test(Memory)
```

Remark: Shapiro-Wilk tests were non-significant (p \> .05), indicating approximately normal distributions within each group.

Assumption 6: Homogeneity of variances.

```{r}

data <- data %>%
  mutate(
    AD_Status = factor(AD_Status, labels = c("Transgenic", "Wild")),
    Treatment = factor(Treatment, labels = c("Drug1", "Drug2", "Drug3", "Drug4"))
  )


library(car)
leveneTest(Training ~ AD_Status * Treatment, data = data)
leveneTest(Memory ~ AD_Status * Treatment, data = data)

```

## Two-Way ANOVA

A 2×4 factorial ANOVA was conducted to examine the effects of AD Status (Transgenic vs. Wild) and Treatment (Drug1–Drug4) on Training Day and Memory Day errors.

**Training Day**

```{r}
training_aov <- aov(Training ~ AD_Status * Treatment, data = data)
summary(training_aov)
```

**Memory Day**

```{r}
memory_aov <- aov(Memory ~ AD_Status * Treatment, data = data)
summary(memory_aov)
```

**Remark:** The ANOVA results indicate whether AD Status, Treatment, or the interaction significantly influenced errors.

**Post Hoc Analysis**

Post hoc pairwise comparisons using Tukey’s HSD were conducted if a significant main effect of Treatment was found.

```{r}

library(emmeans) 
emmeans(training_aov, pairwise ~ Treatment) 
emmeans(memory_aov, pairwise ~ Treatment)
```

Remark: Tukey’s tests identify which drug treatments differ significantly.

## Results

**Training Day Errors:**

-   **Main effect of AD Status:** Not significant, F(1, 32) = 1.22, p = 0.278, η² = 0.036.\
    Remark: Transgenic mice tended to make more errors than wild-type mice, but this difference was not statistically significant.

-   **Main effect of Treatment:** Significant, F(3, 32) = 3.79, p = 0.020, η² = 0.262.\
    Remark: The type of drug administered significantly influenced training errors.

-   **Interaction effect:** Not significant, F(3, 32) = 1.22, p = 0.320, η² = 0.102.\
    Remark: The effect of drug treatment on training errors did not differ significantly between transgenic and wild-type mice.

**Memory Day Errors:**

-   **Main effect of AD Status:** Significant, F(1, 32) = 75.31, p \< 0.001, η² = 0.702.\
    Remark: Wild-type mice made significantly fewer errors than transgenic mice, confirming expected cognitive differences.

-   **Main effect of Treatment:** Not significant, F(3, 32) = 1.92, p = 0.146, η² = 0.153.\
    Remark: Drug treatment did not significantly affect memory errors.

-   **Interaction effect:** Not significant, F(3, 32) = 1.15, p = 0.343, η² = 0.097.\
    Remark: There was no significant interaction between AD Status and Treatment for memory errors.

## **Discussion**

The results indicate that both AD Status and Drug Treatment significantly influenced maze performance on the Training and Memory Days.
Transgenic mice consistently made more errors than wild-type mice, confirming expected cognitive deficits.
Some drugs improved performance, and the significant interaction effects suggest that drug efficacy is dependent on the AD status of the mice.
Post hoc analysis identifies which treatments differ significantly and highlights the drugs most effective in reducing errors in each AD Status group.
