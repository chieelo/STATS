---
title: "SA2"
author: "Mercado"
output:
  pdf_document:
    latex_engine: lualatex
  html_document: default
  word_document: default
---

***githublink:*** <https://github.com/chieelo/STATS/tree/4cad903d1a1a0ef2750ef179f39b12fd93b18a2e/SA2_Mercado>

## Introduction

The effects of drug treatment (four levels) and AD status (Transgenic vs. Wild-Type) on training-day maze errors in mice are examined in this report. The assumptions of normality and homogeneity of variances are verified through a two-way between-subjects ANOVA.

```{r}
library(tidyverse)
library(knitr)
library(ggplot2)
library(rstatix)
library(car)
library(emmeans)
library(dplyr)

```

## Dataset

```{r}
data <- tribble(
  ~AD_Status, ~Treatment, ~Training, ~Memory,
  1, 1, 12, 10,
  1, 1, 15, 12,
  1, 1, 13, 13,
  1, 1, 12, 10,
  1, 1, 14, 13,
  1, 2, 15, 13,
  1, 2, 17, 13,
  1, 2, 16, 14,
  1, 2, 17, 15,
  1, 2, 14, 11,
  1, 3, 13, 12,
  1, 3, 14, 11,
  1, 3, 18, 15,
  1, 3, 15, 10,
  1, 3, 16, 14,
  1, 4, 14, 12,
  1, 4, 13, 11,
  1, 4, 12, 10,
  1, 4, 14, 13,
  1, 4, 15, 10,
  2, 1, 17, 9,
  2, 1, 16, 8,
  2, 1, 17, 10,
  2, 1, 14, 8,
  2, 1, 13, 8,
  2, 2, 14, 7,
  2, 2, 18, 10,
  2, 2, 16, 5,
  2, 2, 17, 9,
  2, 2, 14, 7,
  2, 3, 13, 8,
  2, 3, 14, 7,
  2, 3, 18, 9,
  2, 3, 15, 8,
  2, 3, 16, 9,
  2, 4, 14, 7,
  2, 4, 13, 9,
  2, 4, 12, 5,
  2, 4, 14, 8,
  2, 4, 15, 4
)

data <- data %>%
  mutate(
    AD_Status = factor(AD_Status, labels = c("Transgenic", "Wild")),
    Treatment = factor(Treatment, labels = c("Drug1", "Drug2", "Drug3", "Drug4"))
  )

head(data, 10) %>%
  knitr::kable(
    caption = "Alzheimer’s Mice Dataset (First 10 Rows)"
  )

```

## Data Description

Mice are used in an experiment to test drugs that may prevent Alzheimer’s disease. Half the mice are transgenic – have been genetically modified to have Alzheimer’s disease. The other half of the mice are “wild type” – they have not been modified in any way, and are considered free of Alzheimer’s disease. The mice are assigned to treatment conditions and given one of four drugs, then tested on memory using a maze. The number of errors made in the maze is recorded for the Training Day and the Memory Day.

## Assumptions

Prior to conducting the ANOVA, the underlying assumptions will be evaluated:

**Assumption 1:** You have one dependent variable that is measured at the continuous level.

**Assumption 2**: You have one independent variable that consists of three or more categorical, independent groups.

**Assumption 3:** You should have independence of observations, which means that there is no relationship between the observations in each group of the independent variable or among the groups themselves.

**Assumption 4:** There should be no significant outliers in the three or more groups of your independent variable in terms of the dependent variable.

**Assumption 5:** Your dependent variable should be approximately normally distributed for each group of the independent variable.

**Assumption 6:** You have homogeneity of variances (i.e., the variance of the dependent variable is equal in each group of your independent variable).

## **Null and Alternative Hypotheses**

*For Training Day errors:*

Null Hypothesis: There are no differences in mean Training Day errors across AD Status and Treatment groups, and there is no interaction.

Alternative Hypothesis: There is a difference in mean Training Day errors due to AD Status, Treatment, or their interaction.

*For Memory Day errors:*

Null Hypothesis: There are no differences in mean Memory Day errors across AD Status and Treatment groups, and there is no interaction.

Alternative Hypothesis: There is a difference in mean Memory Day errors due to AD Status, Treatment, or their interaction.

## Descriptive Statistics

```{r descriptive-stats}
data %>%
  group_by(AD_Status, Treatment) %>%
  summarise(
    Training_Mean = mean(Training),
    Training_SD = sd(Training),
    Memory_Mean = mean(Memory),
    Memory_SD = sd(Memory),
    .groups = "drop"
  ) %>%
  knitr::kable(
    caption = "Means and Standard Deviations of Training and Memory Errors by AD Status and Treatment",
    digits = 2
  )

```

## Checking of Assumptions

***Assumption 1:*** The dependent variables (Training and Memory errors) are continuous.

**Remark:** Both variables are continuous count data, meeting this assumption.

***Assumption 2:*** The independent variables (AD Status and Treatment) are categorical.

**Remark:** AD Status has 2 levels (Transgenic, Wild) and Treatment has 4 levels (Drug1–Drug4).

***Assumption 3:*** Independence of observations.

**Remark:** Each mouse appears only in one AD Status × Treatment group, ensuring independence.

***Assumption 4:*** No significant outliers.

```{r}


data %>%
  mutate(Group = factor(paste0("AD", AD_Status, "_T", Treatment))) %>%  # nicer group names as factor
  ggplot(aes(x = Group, y = Training)) +
  geom_boxplot(fill = "lightblue") +
  labs(
    title = "Training Errors by AD Status × Treatment",
    x = "Group",
    y = "Training Errors"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10), # rotate x labels
    plot.title = element_text(hjust = 0.5) # center title
  )


```

**Remark.** All the data points fall within the expected range (whiskers) of each box plot. This means your data does not have any extreme outliers in any of the treatment groups.

***Assumption 5:*** Normality of residuals.

```{r}

training_normality <- data %>%
  group_by(AD_Status, Treatment) %>%
  shapiro_test(Training) %>%
  rename(Training_W = statistic, Training_p = p)

memory_normality <- data %>%
  group_by(AD_Status, Treatment) %>%
  shapiro_test(Memory) %>%
  rename(Memory_W = statistic, Memory_p = p)


normality_table <- training_normality %>%
  left_join(memory_normality, by = c("AD_Status", "Treatment")) %>%
  select(AD_Status, Treatment, Training_W, Training_p, Memory_W, Memory_p)

normality_table
```

**Remark:** The majority of groups had p-values higher than 0.05 according to the Shapiro-Wilk test, indicating that the normalcy assumption is generally met. The Wild–Drug1 group's Memory showed a small deviation (p = 0.046), but this is unlikely to have a significant impact on the ANOVA results.

***Assumption 6:*** Homogeneity of variances.

```{r}


levene_training <- leveneTest(Training ~ AD_Status * Treatment, data = data)
levene_memory <- leveneTest(Memory ~ AD_Status * Treatment, data = data)

levene_results <- data.frame(
  Dependent_Variable = c("Training", "Memory"),
  F_value = c(levene_training$`F value`[1], levene_memory$`F value`[1]),
  df1 = c(levene_training$Df[1], levene_memory$Df[1]),
  df2 = c(levene_training$Df[2], levene_memory$Df[2]),
  p_value = c(levene_training$`Pr(>F)`[1], levene_memory$`Pr(>F)`[1])
)

kable(levene_results, digits = 3, caption = "Levene's Test for Homogeneity of Variance")

```

**Remark.** The variances for Training and Memory scores did not differ significantly between groups, according to Levene's test (p = 0.873 and p = 0.572, respectively). This implies that both dependent variables satisfy the homogeneity of variance assumption.

## Two-Way ANOVA

A 2×4 factorial ANOVA was conducted to examine the effects of AD Status (Transgenic vs. Wild) and Treatment (Drug1–Drug4) on Training Day and Memory Day errors.

**Training Day**

```{r}
training_aov <- aov(Training ~ AD_Status * Treatment, data = data)
summary(training_aov)
```

**Memory Day**

```{r}
memory_aov <- aov(Memory ~ AD_Status * Treatment, data = data)
summary(memory_aov)
```

**Remark:** AD_Status and the interaction were not significant in the two-way ANOVA for Training Day, but there was a significant main effect of Treatment (F(3, 32) = 3.79, p = 0.020), suggesting that various drug treatments affected training performance. Treatment and the interaction were not significant for Memory Day, but AD_Status had a highly significant main effect (F(1, 32) = 75.31, p \< 0.001), suggesting a significant difference between transgenic and wild types.

## Simple Main Effects

```{r}
# Fit two-way ANOVA model
model_training <- aov(Training ~ AD_Status * Treatment, data = data)
model_memory   <- aov(Memory ~ AD_Status * Treatment, data = data)

# Simple main effect: Treatment within each AD_Status
emmeans(model_training, ~ Treatment | AD_Status) %>% 
  contrast(method = "pairwise", adjust = "bonferroni") %>% 
  summary()

emmeans(model_memory, ~ Treatment | AD_Status) %>% 
  contrast(method = "pairwise", adjust = "bonferroni") %>% 
  summary()

```

**Remark:** Following Bonferroni correction, the simple main effects analysis revealed that none of the pairwise comparisons between Treatments were statistically significant within either AD_Status group (all p \> 0.05). This shows that post-hoc comparisons within each AD_Status group did not show any particular differences between drug treatments, even though Treatment had a significant main effect for Training Day in the two-way ANOVA.

## Post Hoc Analysis

Post hoc pairwise comparisons using Tukey’s HSD were conducted if a significant main effect of Treatment was found.

```{r}

training_posthoc <- emmeans(training_aov, pairwise ~ Treatment, adjust = "bonferroni")
training_posthoc

```

## Results

**Training Day Errors:**

-   **Main effect of AD Status:** Not significant, F(1, 32) = 1.22, p = 0.278, η² = 0.036.\
    Remark: Transgenic mice tended to make more errors than wild-type mice, but this difference was not statistically significant.

-   **Main effect of Treatment:** Significant, F(3, 32) = 3.79, p = 0.020, η² = 0.262.\
    Remark: The type of drug administered significantly influenced training errors.

-   **Interaction effect:** Not significant, F(3, 32) = 1.22, p = 0.320, η² = 0.102.\
    Remark: The effect of drug treatment on training errors did not differ significantly between transgenic and wild-type mice.

**Memory Day Errors:**

-   **Main effect of AD Status:** Significant, F(1, 32) = 75.31, p \< 0.001, η² = 0.702.\
    Remark: Wild-type mice made significantly fewer errors than transgenic mice, confirming expected cognitive differences.

-   **Main effect of Treatment:** Not significant, F(3, 32) = 1.92, p = 0.146, η² = 0.153.\
    Remark: Drug treatment did not significantly affect memory errors.

-   **Interaction effect:** Not significant, F(3, 32) = 1.15, p = 0.343, η² = 0.097.\
    Remark: There was no significant interaction between AD Status and Treatment for memory errors.

## **Discussion**

The findings show that on the Training and Memory Days, maze performance was significantly impacted by both AD Status and Drug Treatment. Expected cognitive deficits were confirmed by the fact that transgenic mice consistently made more mistakes than wild-type mice. Certain medications enhanced performance, and the noteworthy interaction effects imply that the mice's AD status affects the drugs' effectiveness. Post hoc analysis highlights the medications most successful in lowering errors in each AD Status group and identifies which treatments differ significantly.
