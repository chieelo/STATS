---
title: "FA3"
author: "Borromeo Mayo Mercado"
date: "2025-09-14"
output: html_document
---

<style>
h1.title {
  text-align: center;
}
h4.author {
  text-align: center;
}
h4.date {
  text-align: center;
}
</style>


```{r setup, include=FALSE}
library(e1071)   
library(knitr)  
library(kableExtra)

scores <- c(
  88, 45, 53, 86, 33, 86, 85, 30, 89, 53, 41, 96, 56, 38, 62,
  71, 51, 86, 68, 29, 28, 47, 33, 37, 25, 36, 33, 94, 73, 46,
  42, 34, 79, 72, 88, 99, 82, 62, 57, 42, 28, 55, 67, 62, 60,
  96, 61, 57, 75, 93, 34, 75, 53, 32, 28, 73, 51, 69, 91, 35
)

getmode <- function(v) {
  uniqv <- sort(unique(v))
  tab <- tabulate(match(v, uniqv))
  modes <- uniqv[tab == max(tab)]
  return(list(mode = min(modes), multiple = (length(modes) > 1)))
}

mode_result <- getmode(scores)
sup_a <- "\u1d43" 


n <- length(scores)

skew_val <- (n / ((n - 1) * (n - 2))) * sum(((scores - mean(scores)) / sd(scores))^3)
se_sk <- sqrt( 6 * n * (n - 1) / ((n - 2) * (n + 1) * (n + 3)) )
kurt_val <- ( n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) ) *
            sum((scores - mean(scores))^4) / (sd(scores)^4) -
            3 * ((n - 1)^2) / ((n - 2) * (n - 3))
se_ku <- sqrt( 4 * (n^2 - 1) * (se_sk^2) / ((n - 3) * (n + 5)) )


desc <- data.frame(
  Label = c(
    "Valid", "Mode", "Median", "Mean", "Std. Deviation", "Variance",
    "Skewness", "Std. Error of Skewness", "Kurtosis", "Std. Error of Kurtosis",
    "Minimum", "Maximum", "25th percentile", "50th percentile",
    "75th percentile", "90th percentile", "95th percentile"
  ),
  Score = c(
    sprintf("%.3f", length(scores)),
    if (mode_result$multiple) paste0(sup_a, " ", sprintf("%.3f", mode_result$mode)) else sprintf("%.3f", mode_result$mode),
    sprintf("%.3f", median(scores)),
    sprintf("%.3f", mean(scores)),
    sprintf("%.3f", sd(scores)),
    sprintf("%.3f", var(scores)),
    sprintf("%.3f", skew_val),
    sprintf("%.3f", se_sk),
    sprintf("%.3f", kurt_val),
    sprintf("%.3f", se_ku),
    sprintf("%.3f", min(scores)),
    sprintf("%.3f", max(scores)),
    sprintf("%.3f", quantile(scores, 0.25)),
    sprintf("%.3f", quantile(scores, 0.50)),
    sprintf("%.3f", quantile(scores, 0.75)),
    sprintf("%.3f", quantile(scores, 0.90)),
    sprintf("%.3f", quantile(scores, 0.95))
  ),
  stringsAsFactors = FALSE
)

colnames(desc)[1] <- ""
```

```{r echo=FALSE}
kable(desc, format = "html", digits = 3,
      caption = "Descriptive Statistics") %>%
  kable_styling(full_width = FALSE, position = "center") %>%
  footnote(
    general = if (mode_result$multiple) {
      paste0(sup_a, " More than one mode exists, only the first is reported.")
    } else { NULL },
    general_title = "Note: ",
    threeparttable = TRUE
  )

```





